<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-form/iron-form.html">
<link rel="import" href="../paper-input/paper-textarea.html">
<link rel="import" href="../paper-material/paper-material.html">
<link rel="import" href="../paper-toolbar/paper-toolbar.html">

<link rel="import" href="../things-ajax/things-ajax.html">

<!--
  에러 발생시 상세 정보를 표시해주는 페이지 

  Example:
    <things-error-page error-id="5731ca1e0d86acf24ac4b544">
    </things-error-page>  
-->
<dom-module id="things-error-page">
	<template>

		<style>
			:host {
				display: block;
			}
		</style>

		<things-ajax 
			auto
			id="resource"
			method="GET"
			resource-url="[[resourceUrl]]"
			resource-id="[[errorId]]"
			last-response="{{resource}}">
		</things-ajax>

		<paper-material elevation="1" class="flex">
			<div class="layout vertical flex">
				<form is="iron-form" id="resource-form">
					<paper-textarea name="message" label="Message" value="{{resource.message}}"></paper-textarea>
					<paper-input name="issue_date" label="Occurred Time" value="{{resource.issue_date}}"></paper-input>
					<paper-input name="code" label="Code" value="{{resource.code}}"></paper-input>
					<paper-input name="status" label="Status" value="{{resource.status}}"></paper-input>
					<paper-input name="error_type" label="Error Type" value="{{resource.error_type}}"></paper-input>
					<paper-input name="uri" label="URL" value="{{resource.uri}}"></paper-input>
					<paper-input name="method" label="Method" value="{{resource.method}}"></paper-input>
					<paper-textarea label="Header" value="{{resource.header}}" rows=4></paper-textarea>
					<paper-textarea label="Parameters" value="{{resource.params}}" rows=4></paper-textarea>
					<paper-textarea label="Stack Trace" value="{{resource.stack_trace}}" rows=4></paper-textarea>
				</form>
			</div>
		</paper-material>

	</template>

	<script>
		Polymer({

			is: 'things-error-page',

			properties: {
				title: {
					type: String,
					computed: '_computeTitle(errorId)'
				},

				errorId: {
					type: String
				},

				resourceUrl: {
					type: String,
					computed: '_computeResourceUrl(errorId)'
				},				

				resource: {
					type: Object
				}
			},

			_computeTitle: function(errorId) {
				return 'Error : ' + errorId;
			},

			_computeResourceUrl: function(errorId) {
				return 'error_logs/' + errorId;
			}

		});
	</script>
</dom-module>